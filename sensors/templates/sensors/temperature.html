<html>
    <head>
        {% load staticfiles %}
        <title>DILUTE</title>
        <link rel="shortcut icon" href="{% static 'users/img/logo-image.jpg' %}">
        <script src="https://use.fontawesome.com/a2c08f3da1.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css">
         <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    </head>
    <body> 
        <nav class="navbar navbar-toggleable-md navbar-light bg-faded">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarTogglerDemo01">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link " href="#">Home </a>
                    </li>
                </ul>
                <ul>
                {% if 'name' in request.session %}
                    Hello {{ request.session.name }} !
                {% endif %}
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item ">
                        <a class="nav-link " href="{% url 'sensors:logout' %}">Logout</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="login-page" style="float: left;margin-right: 10px;margin-left: 100px;">
            <div class="form">
                <a href="{% url 'users:addplant' %}">Add Plant</a><br>

                {% if plant_names %}
                        <ul>
                            {% for name in plant_names %}
                                <li>{{ name }}</li>
                            {% endfor %}
                        </ul>
                        {% else %}
                            No plants added!
                        {% endif %}<br>
            </div>
        </div>

        <div class="login-page" style="float: left;margin-right: 10px;margin-left: 100px;">
            <div class="form">
                <a href="{% url 'users:addVehicle' %}">Add Vehicle</a><br>

                  {% if vehicle_name %}
                          <ul>
                              {% for name in vehicle_name %}
                                  <li>{{ name }}</li>
                              {% endfor %}
                          </ul>

                          {% else %}
                              No Vehicle added!
                          {% endif %}<br>
            </div>
        </div>

        <div class="login-page" style="float: left;margin-right: 10px;margin-left: 100px;">
            <div class="form">
              <a href="{% url 'users:addMember' %}">Add Member</a><br>

              {% if member_names %}
                      <ul>
                          {% for name in member_names %}
                              <li>{{ name }}</li>
                          {% endfor %}
                      </ul>
                      {% else %}
                          No Members added!
                      {% endif %}<br>
            </div>
          </div>
        <!-- <a href="{% url 'users:addReservoir' %}">Add Reservoir</a><br> -->

        <div class="login-page" style="margin-right: 10px;margin-left: 1200px;">
            <div class="form">

                Reservoirs
                <br>
                {% if reservoir_names %}
                        <ul>
                            {% for name in reservoir_names %}
                                <li><a href="{% url 'sensors:detail'  name.id %}">{{ name }}</a></li>
                            {% endfor %}
                        </ul>
                        {% else %}
                            No Reservoirs added!
                        {% endif %}<br>
            </div>
        </div>
<br><br>
                
       <!--  <form name="myform1" role="form" action="{% url 'sensors:setreservoir' %}" method="post" class="register-form">
                        {% csrf_token %}
                        <select name="currentplant">
                            {% for name in reservoir_names %}
                                {% if userdata.currentreservoir == name.id %}
                                    <option value="{{name.id}}" selected >{{ name }}</option>
                                {% else %}
                                    <option value="{{name.id}}" >{{ name }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        <br><br><br><br>
                        <span style="text-align: center;font-style:bold;font-family:'Comic Sans MS';font-size:20px;color:#295004">
                        <button type="submit"><p  style="color:#295004">Select Reservoir</p></button>
                        </span>
                    </form>
 -->
            <!-- <div class="card" style="float: left;margin-left: 450px; " >
                <center><br>
                    <p style="text-align: center;color:#295004;font-style:bold;font-family:'Comic Sans MS';font-size:18px;"></p>
                </center>
                
                <center>
                    <div class="boxed">
                        <span style="text-align: center;font-style: italic;font-family:'Comic Sans MS';font-size:20px;color:#295004">
                            
                        </span>
                    </div>
                </center>
            </div>
            <div class="card" >

                <span style="text-align: center;font-style:bold;font-family:'Comic Sans MS';font-size:20px;color:#295004"><br>
                   <center></center><br><br>
                </span>
                <center>
                    
                </center>
            </div> --><div style="font-size: 20px;text-align: center;">
          {% if plant_count %}
            You Have {{ plant_count }} plants.
          {% endif %}
          <br>
            {% if member_count %}
            You Have {{ member_count }} members.
            {% endif %}
            <br>
            {% if vehicle_count %}
            You Have {{ vehicle_count }} vehicles.
            {% endif %}</div>
          <br><br><br><br>
        <div style="font-size: 30px">
        <center>
         <div id="time"></div>
         <div id="date"></div>
         <div id="reservoir"></div>
        </center>  
        </div>
        <br><br><br>
    </body>
        
        <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="{% static 'sensors/js/Rx.min.js' %}"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
    
    <style>
        .boxed {
          border: 3px solid #4CAF50 ;
          width:200px;
          border-radius: 8px;
          background:#4CAF50  ;
        }
        .card {
          background: #fff;
          border-radius: 5px;
          display: inline-block;
          height: 350px;
          margin: 1rem;
          position: relative;
          width: 300px;
          color:#EDF7E2;
          /*margin-left: 250px;*/
          margin-top: 75px;
          height: auto;
          padding-bottom:10px;}
        ul {
            list-style-type: square;
            color:#295004;
        }
        button
        {
          border: 3px solid #4CAF50  ;
          width:200px;
          border-radius: 8px;
          background:#4CAF50 ;
        }  
        select {
            padding:3px;
            margin: 0;
            -webkit-border-radius:4px;
            -moz-border-radius:4px;
            border-radius:4px;
            -webkit-box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            -moz-box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            box-shadow: 0 3px 0 #ccc, 0 -1px #fff inset;
            background: #BEDED9;
            color:#000200;
            border:none;
            outline:none;
            display: inline-block;
            -webkit-appearance:none;
            -moz-appearance:none;
            appearance:none;
            cursor:pointer;
        }
        .alert {
            padding: 20px;
            background-color: #f44336;
            color: white;
        }
        .closebtn {
            margin-left: 15px;
            color: white;
            font-weight: bold;
            float: right;
            font-size: 22px;
            line-height: 20px;
            cursor: pointer;
            transition: 0.3s;
        }
        .closebtn:hover {
            color: black;
        }
        div.transbox {
          margin: 30px;
          background-color: #ffffff;
          border: 1px solid black;
          opacity: 0.6;
          filter: alpha(opacity=60); /* For IE8 and earlier */
        }   
       body {
        background: aqua; /* fallback for old browsers *
        /*background: -webkit-linear-gradient(right, #76b852, #8DC26F);
        background: -moz-linear-gradient(right, #76b852, #8DC26F);
        background: -o-linear-gradient(right, #76b852, #8DC26F);
        background: linear-gradient(to left, #76b852, #8DC26F);
        font-family: "Roboto", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;   */   
      }

      .login-page {
  width: 250px;
  padding: 5% 0 0;
  margin: auto;
}
.form {
  position: relative;
  z-index: 1;
  background: #FFFFFF;
  max-width: 360px;
  margin: 0 auto 50px;
  padding: 30px;
  text-align: center;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
}
.form {
  position: relative;
  z-index: 1;
  background: #FFFFFF;
  max-width: 360px;
  margin: 0 auto 50px;
  padding: 30px;
  text-align: center;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
}
.form input {
  font-family: "Roboto", sans-serif;
  outline: 0;
  background: #f2f2f2;
  width: 100%;
  border: 0;
  margin: 0 0 15px;
  padding: 10px;
  box-sizing: border-box;
  font-size: 14px;
}
.form button {
  font-family: "Roboto", sans-serif;
  text-transform: uppercase;
  outline: 0;
  background: #4CAF50;
  width: 100%;
  border: 0;
  padding: 15px;
  color: #FFFFFF;
  font-size: 14px;
  -webkit-transition: all 0.3 ease;
  transition: all 0.3 ease;
  cursor: pointer;
}
.form button:hover,.form button:active,.form button:focus {
  background: #43A047;
}
    </style>
</html>




<center>
        <div id="chart_div_humidity" style="width: 300px; height: 300px;float: left;"></div>
        <div id="chart_div_temp" style="width: 300px; height: 300px;float: left;"></div>
        <div id="chart_div_distance" style="width: 300px; height: 300px;float: left;"></div>
        <div id="chart_div_soil" style="width: 300px; height: 300px;float: left;"></div>
        <div id="chart_div_pres" style="width: 300px; height: 300px;float: left;"></div>
        <div id="rain" style="display: none; "><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAB7CAMAAABjGQ9NAAAAwFBMVEX///+VlZX/8gBtz/aSkpKPj49kzfbl5eWUlJaMjIz/9wCgoKCQkZn8/PyRkpj/9QC4uLjy+v7r6+v29vaoqKjIyMi+vr7c3Nz//vXQ0NDh9P3P7vyW2/jW1tZ/1Pe55vql4PmHiZ///df/+ar/8zdKx/TFwWv/8yTu67Pj48f//s7//en/+aH/+Jn/9Ef/9Wny5yzd1kr/93nLxE3/+rb/+I7/9Vm4tXP/+8KrqIWloomZmJC3snidnYvEvl3X0VfqO0ZbAAAEyUlEQVRoge2Ze3vaNhSHEZYMvmJs2cZgG5akzda0KaTbsoyGfv9vVUkG4yu2JDb6h3/P06eAL6/ORUdHymhU1N9joufF6Ba6p+zxbdifGPvuJuynR8r+8ybsLOAvt2H/Rdlfb8NmAX+4TbI9sWR74njCDaMgCPzQtWTZi2fK/pR//eeyC6wEA4QQpP8M35WEv1D2l+zz0/1zeb5ZHlHBvtBAEJwEEfDlbL/Pk+3upTTfvCjABiEAAwdhxgg0UJaGPRn2HauqZAzM+fl8SwwNwaONEGrQJ7/5VTQACMtYvqDV5fFlfBJzwaTo2yNkFNXRxHJfxvCvOfbh4biwTCCsQVDQQCY+MWTYX07kz4vP1AVkvjVSWmSMLDcJHIyx4094o58tJ4/3i+PHu9GkybmtCgyNpgYR0gzexD+RR9YfM/L5d052KT6awWf64wObVyHWEEHr30ynHu3+IwFclrNq4mENgul2PJ7tTIqe2qYYHDlchhO5gALt3Ww829qEbILXH4JwwJlwGRqYB53Efm+b74etvv1NDA35qryFswjbr4Q9fnvbjekY/h92iLLHpu+UvdVnbNoJsjl9nie2rWd1ZqYLsyFnruET29xm4N2B/AemImzEuajndps7Xd/uXvemvZ3p70JsI+GrrP4x3sD+uPu+N80pML/p+r9CbEBWQBz2LzCTExvYps2I9pswmwhqeNLf6ajy9HS/lWDTIt877BaulnDzh/5qi7M51nWvtnwQp38ULapMKOyHjkB95bLHBzl2v2YqqEabytwJLyYc7OZWwf4ux4ZJH7bR3CrYOzl2n0T3Wjok8yCFxn3MTtq6s70Mu1+at7IlSkvfzsnl6kr7CfZtV6+PRkbfitqwxZMT5Nij4abaIiHEsYBbjiaxG6gLRv3ZdE+CtOquV4LN17KRvaRfW0eF2fz74uhaYRdg+1djc2/JRsm12KjXElaSdyW00DFIa2XnQwOhIz9ffp5BhAVPG+m5YX6oxhN+dDxxQTgRP3ALA4O+CBhONGnopqBhNJE9LwkCJ/BDqWNGKss6jr3etgO3obvr16N0Y8tf3UrzDCdNZUDrvwG6pHXlewkOAWuEosqpoxZcBT3/MK/84uE8+fKOwMWFPIT8B0vNWqtVw1nuI5rBRqFauU6e2capKVxKsmM1bfiVrHF+Up21kyhwnCDKQ72M5dBzVVGrTq/csWm7slbl/oawJuy604tato4tVVdS7FhRlMuuW7cRlmrHkx2aK1QXnZ6qLYSN2vFkh8jYFUW9lK9Lcr3xgpWSKzJOXzP2pYDThGgkkCxV2lzCwd5cuCNtu84eTSUyvWp3zcIlS4jz93OAabgVRaK8ZPHOifO0mjwrdsP517OhqdKVKh2a0zecgavauzaVwZ0/xrJsYrhaeD6uhXZTDsrqnF2MLeNzYsmq4GZVqTq9wo6VvI6yaDStBWIir6s6cVUqAPPihEvbZp+Q4vpcZ4Uvt44ObpNfitProS2lwYsrRT0HNVa7KrCo2ISrvXp5Toi5dGq3al2eTw2DU7oqsLA2XcWdJZ7cwvkrsjt9vupceYTVnGvFG5SOwUlo09W80Rtkls1LWqcdSRx/+G+m96BBgwYNGjRo0KBBgwYNGjRo0KBBg34x/QTFzlA01Xo1YQAAAABJRU5ErkJggg=="></div>
    </center>

    
    </body>
        
        <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="{% static 'sensors/js/Rx.min.js' %}"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"
        crossorigin="anonymous"></script>
    <script type="text/javascript">


        let myObser = Rx.Observable.timer(0, 10000).map(() => fetch(`/sensors/dataupdate/`).then(res => res.json()))
        myObser.subscribe(x => x.then(data => {
            if(data.time){
            document.getElementById('time').innerHTML = data.time
            document.getElementById('date').innerHTML = data.date

            }
            else
            {
              document.getElementById('time').innerHTML = "no data"
              document.getElementById('date').innerHTML = "no data"
            }
            if(data.rain)
              document.getElementById('rain').style.display = 'block';
            else
              document.getElementById('rain').style.display = 'none';

            google.charts.load('current', {'packages':['gauge']});
            google.charts.setOnLoadCallback(drawChart);

            function drawChart() {

                var value1 = google.visualization.arrayToDataTable([
                  ['Label', 'Value'],
                  ['Humidity(%)', data.humidity],
                ]);

                var options1 = {
                  width: 300, height: 300,
                  redFrom: 50, redTo: 65, redColor: 'green',
                  yellowFrom:40, yellowTo: 75,
                  greenFrom: 0, greenTo: 100, greenColor: 'red',
                  minorTicks: 10,
                  //majorTicks: ['0%','25%','50%','75%','100%'],
                  animation:{
        duration: 5000,
        easing: 'out',
      },
                };

                var value2 = google.visualization.arrayToDataTable([
                  ['Label', 'Value'],
                  ['Temp(C)', data.temp],
                ]);

                var options2 = {
                 width: 300, height: 300,
                  redFrom: 30, redTo: 100,
                  yellowFrom:22, yellowTo: 40,yellowColor:'#b2b2ff', 
                  greenFrom: 0, greenTo: 22, greenColor:'#4c4cff',
                  minorTicks: 10,
                  animation:{
        duration: 5000,
        easing: 'out',
      },
                };

                var value3 = google.visualization.arrayToDataTable([
                  ['Label', 'Value'],
                  ['W.Level(%)', data.distance],
                ]);

                var options3 = {
                 width: 300, height: 300,
                  greenFrom: (35-12)*100/35, greenTo: (35-0)*100/35,
                  yellowFrom:(35-25)*100/35, yellowTo: (35-12)*100/35, 
                  redFrom: (35-35)*100/35, redTo: (35-25)*100/35, 
                  minorTicks: 10,
                  animation:{
        duration: 5000,
        easing: 'out',
      },
                };

                var value4 = google.visualization.arrayToDataTable([
                  ['Label', 'Value'],
                  ['S.Moisture(%)', data.soilmoist],
                ]);

                var options4 = {
                   width: 300, height: 300,
                  redFrom: 30, redTo: 60, redColor:'green',
                  yellowFrom:20, yellowTo: 80, 
                  greenFrom:0, greenTo: 100, greenColor:'red',
                  minorTicks: 10,
                  animation:{
        duration: 5000,
        easing: 'out',
      },
                };

                var value5 = google.visualization.arrayToDataTable([
                  ['Label', 'Value'],
                  ['Press.(Pa)', data.pressure],
                ]);

                var options5 = {
                 width: 300, height: 300,
                  redFrom: 98000, redTo: 105000, redColor:'green',
                  yellowFrom:94000, yellowTo: 110000, 
                  greenFrom:90000, greenTo: 115000, greenColor:'red',
                  minorTicks: 10, min: 90000, max: 115000,
                  animation:{
        duration: 5000,
        easing: 'out',
      },
                };
                

                var chart1 = new google.visualization.Gauge(document.getElementById('chart_div_humidity'));
                chart1.draw(value1, options1);

                var chart2 = new google.visualization.Gauge(document.getElementById('chart_div_temp'));
                chart2.draw(value2, options2);
                var chart3 = new google.visualization.Gauge(document.getElementById('chart_div_distance'));
                
                chart3.draw(value3, options3);

                var chart4 = new google.visualization.Gauge(document.getElementById('chart_div_soil'));
                chart4.draw(value4, options4);
                var chart5 = new google.visualization.Gauge(document.getElementById('chart_div_pres'));
                chart5.draw(value5, options5);


              }


        }
        ))
    </script>